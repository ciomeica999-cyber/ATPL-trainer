<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>ATPL PRO v19</title>
<style>
:root{--primary:#007aff;--orange:#ff9f0a;--purple:#af52de;--bg:#f2f2f7;--card:#ffffff;--text:#000;--sub:#6c6c70;--border:#c6c6c8;--ok:#34c759;--no:#ff3b30;--shadow:0 4px 20px rgba(0,0,0,0.1)}
@media(prefers-color-scheme:dark){:root{--primary:#0a84ff;--bg:#000;--card:#1c1c1e;--text:#fff;--sub:#aeaeb2;--border:#38383a}}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}
body{margin:0;background:var(--bg);color:var(--text);height:100dvh;display:flex;flex-direction:column;overflow:hidden}
header{height:50px;background:var(--card);border-bottom:0.5px solid var(--border);display:flex;align-items:center;justify-content:space-between;padding:0 20px;font-weight:700;font-size:17px;padding-top:env(safe-area-inset-top);height:calc(50px + env(safe-area-inset-top));z-index:10}
.content{flex:1;overflow-y:auto;padding:20px 20px 150px 20px;-webkit-overflow-scrolling:touch}
.card{background:var(--card);border-radius:16px;padding:20px;margin-bottom:20px;box-shadow:0 2px 10px rgba(0,0,0,0.03)}
.mode-row{display:flex;gap:10px;margin-bottom:15px}
.mode-btn{flex:1;padding:15px;border-radius:12px;background:var(--card);border:2px solid transparent;text-align:center;font-weight:600;font-size:15px;box-shadow:0 2px 5px rgba(0,0,0,0.05);transition:0.2s;cursor:pointer}
.mode-btn.active-practice{border-color:var(--primary);background:rgba(0,122,255,0.1);color:var(--primary)}
.mode-btn.active-formulas{border-color:var(--purple);background:rgba(175,82,222,0.1);color:var(--purple)}
.mode-btn.active-exam{border-color:var(--orange);background:rgba(255,159,10,0.1);color:var(--orange)}
select{width:100%;padding:12px;border-radius:10px;background:var(--bg);color:var(--text);border:1px solid var(--border);margin-bottom:20px;font-size:16px}
.btn-start{width:100%;padding:16px;border-radius:14px;border:none;font-size:17px;font-weight:700;color:#fff;background:var(--primary);cursor:pointer;box-shadow:0 4px 10px rgba(0,0,0,0.2)}
.q-meta{display:flex;justify-content:space-between;font-size:12px;color:var(--sub);margin-bottom:10px;font-weight:600;text-transform:uppercase}
.q-text{font-size:18px;line-height:1.4;margin-bottom:25px;font-weight:600}
.option{width:100%;padding:18px;margin-bottom:12px;background:var(--bg);border:2px solid transparent;border-radius:14px;font-size:16px;color:var(--text);cursor:pointer;position:relative}
.option.correct{background:rgba(52,199,89,0.15);border-color:var(--ok)}
.option.wrong{background:rgba(255,59,48,0.15);border-color:var(--no)}
.option.selected{background:rgba(0,122,255,0.15);border-color:var(--primary)}
body.mode-formulas .option.selected{border-color:var(--purple);background:rgba(175,82,222,0.15)}
body.mode-exam .option.selected{border-color:var(--orange);background:rgba(255,159,10,0.15)}
.explanation{margin-top:20px;padding:15px;background:rgba(255,204,0,0.15);border-radius:12px;font-size:15px;line-height:1.4;border-left:4px solid #ffcc00;display:none}
.explanation.show{display:block}
.btn-deep{background:transparent;border:1px solid var(--text);color:var(--text);padding:8px 15px;border-radius:20px;font-size:13px;font-weight:600;margin-top:10px;cursor:pointer}
.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);backdrop-filter:blur(5px);z-index:2000;display:none;align-items:flex-end}
.modal.open{display:flex;animation:up 0.3s ease-out}
.modal-card{background:var(--card);width:100%;max-height:85vh;border-radius:20px 20px 0 0;padding:25px;overflow-y:auto}
.nav{position:fixed;bottom:80px;left:20px;right:20px;height:60px;background:rgba(255,255,255,0.9);backdrop-filter:blur(20px);border-radius:30px;display:flex;align-items:center;padding:5px;box-shadow:var(--shadow);z-index:999;border:1px solid rgba(255,255,255,0.2)}
@media(prefers-color-scheme:dark){.nav{background:rgba(40,40,40,0.85)}}
.nav-btn{width:50px;height:50px;border-radius:25px;border:none;background:0 0;color:var(--text);font-size:20px;font-weight:700;cursor:pointer}
.nav-btn.primary{background:var(--primary);color:#fff;width:auto;flex:1;margin:0 5px;font-size:17px}
.hidden{display:none!important}
@keyframes up{from{transform:translateY(100%)}to{transform:translateY(0)}}
</style>
</head>
<body>
<header><div>ATPL <span style="color:var(--primary)">MASTER</span></div><div id="cnt" style="font-size:14px;color:var(--sub)">Ready</div></header>
<div id="view-home" class="content">
<div class="card">
<h2 style="margin-top:0">Training Setup</h2>
<div style="font-size:13px;color:var(--sub);margin-bottom:20px" id="dbInfo">Loading...</div>
<div class="mode-row"><div class="mode-btn active-practice" id="m-practice" onclick="app.setM('practice')">üéì Practice</div><div class="mode-btn" id="m-formulas" onclick="app.setM('formulas')">üìê Formulas</div></div>
<div class="mode-btn" id="m-exam" onclick="app.setM('exam')" style="margin-bottom:20px">‚è±Ô∏è Exam Mode</div>
<div id="dif"><select id="diff-sel"><option value="easy">Easy</option><option value="medium" selected>Medium</option><option value="hard">Hard</option></select></div>
<select id="num-sel"><option value="10">10 Questions</option><option value="20" selected>20 Questions</option><option value="50">50 Questions</option><option value="100">100 Questions</option></select>
<button class="btn-start" id="btnStart" onclick="app.go()">START</button>
<div style="text-align:center;margin-top:20px"><a href="#" onclick="app.wipe()" style="color:var(--sub);font-size:12px">Reset</a></div>
</div></div>
<div id="view-quiz" class="content hidden">
<div class="card"><div class="q-meta"><span id="qTop"></span><span id="qLvl" style="color:var(--primary)"></span></div>
<div class="q-text" id="qTxt"></div><div id="opts"></div>
<div id="expl" class="explanation"><span id="sh-exp"></span><br><button class="btn-deep" onclick="app.deep()">üìñ Deep Dive</button></div></div></div>
<div id="nav" class="nav hidden"><button class="nav-btn" onclick="app.back()">‚Üê</button><button class="nav-btn primary" id="act" onclick="app.next()">Next</button><button class="nav-btn" onclick="app.quit()">‚úï</button></div>
<div class="modal" id="mod" onclick="app.close(event)"><div class="modal-card"><h2 style="color:var(--primary)">Deep Dive</h2><div id="dp-txt" style="line-height:1.6"></div><button class="btn-start" style="margin-top:20px" onclick="app.close(null)">Close</button></div></div>
<div id="view-res" class="content hidden" style="text-align:center"><div class="card"><h2>Results</h2><div style="font-size:50px;font-weight:800;margin:30px 0;color:var(--primary)" id="score"></div><button class="btn-start" onclick="location.reload()">Home</button></div></div>
<script>
const DB = [
{ id:"A1", topic:"Atmosphere", level:"medium", q:"In ISA, temp lapse rate is:", options:["2¬∞C/1000ft","3¬∞C","1¬∞C","0¬∞C"], ans:0, exp:"Standard lapse rate.", longExp:"The International Standard Atmosphere assumes a temperature drop of 1.98¬∞C (approx 2¬∞C) per 1000ft up to 11km." },
{ id:"A2", topic:"Atmosphere", level:"hard", q:"Density Altitude is:", options:["Pressure Alt corrected for Temp","Height AGL","Indicated","True"], ans:0, exp:"Performance altitude.", longExp:"DA is the altitude in the standard atmosphere where the prevailing density occurs. High T = High DA = Low Performance." },
{ id:"A3", topic:"Atmosphere", level:"hard", q:"High humidity causes density to:", options:["Decrease","Increase","Stay same","Double"], ans:0, exp:"Water vapor is lighter than air.", longExp:"H2O (18) is lighter than N2 (28) and O2 (32). Humid air is less dense than dry air." },
{ id:"A4", topic:"Atmosphere", level:"medium", q:"Tropopause height at poles:", options:["8km","11km","16km","20km"], ans:0, exp:"Lower at poles due to cold.", longExp:"The tropopause is lower at the poles (approx 26,000ft/8km) and higher at the equator (50,000ft/16km) due to thermal expansion." },
{ id:"A5", topic:"Atmosphere", level:"easy", q:"Standard pressure MSL:", options:["1013.25 hPa","1000 hPa","1025 hPa","760 hPa"], ans:0, exp:"29.92 inHg.", longExp:"1013.25 hPa is the baseline pressure for ISA." },
{ id:"A6", topic:"Atmosphere", level:"hard", q:"QFE sets altimeter to read:", options:["Zero on ground","MSL","FL","Density"], ans:0, exp:"Height above reference.", longExp:"QFE is the pressure at the airfield datum. With QFE set, the altimeter reads zero on the runway." },
{ id:"A7", topic:"Atmosphere", level:"medium", q:"QNH sets altimeter to read:", options:["Altitude AMSL","Height","Zero","Density"], ans:0, exp:"Nautical Height.", longExp:"QNH corrects for pressure so the altimeter reads Altitude Above Mean Sea Level." },
{ id:"L1", topic:"Lift", level:"easy", q:"Lift acts:", options:["Perpendicular to RAF","Vertical","Opposite Weight","Up"], ans:0, exp:"Definition.", longExp:"Lift is the aerodynamic force component perpendicular to the Relative Airflow (Flight Path)." },
{ id:"L2", topic:"Lift", level:"medium", q:"Lift formula:", options:["L = 1/2 œÅ V¬≤ S CL","L = œÅ V S","L = W","L = 1/2 V S"], ans:0, exp:"Dynamic Pressure x Area x CL.", longExp:"Lift depends on air density, velocity squared, wing area, and the lift coefficient." },
{ id:"L3", topic:"Lift", level:"hard", q:"AoA increases, CP moves (cambered):", options:["Forward","Aft","Still","Tip"], ans:0, exp:"Unstable movement.", longExp:"On a cambered wing, increasing AoA moves the suction peak forward, so the Centre of Pressure moves forward." },
{ id:"L4", topic:"Lift", level:"medium", q:"Aspect Ratio:", options:["Span / Mean Chord","Chord/Span","Area/Span","Thick/Chord"], ans:0, exp:"AR = b¬≤/S.", longExp:"High Aspect Ratio (long wings) reduces induced drag." },
{ id:"L5", topic:"Lift", level:"hard", q:"Washout prevents:", options:["Tip Stall","Root Stall","Drag","Flutter"], ans:0, exp:"Twist.", longExp:"Washout reduces the angle of incidence at the tip, ensuring the root stalls first for control." },
{ id:"L6", topic:"Lift", level:"medium", q:"Ground Effect reduces:", options:["Induced Drag","Parasite Drag","Lift","Thrust"], ans:0, exp:"Blocks vortices.", longExp:"Proximity to ground disrupts wingtip vortices, reducing downwash and induced drag." },
{ id:"L7", topic:"Lift", level:"medium", q:"AC is located at:", options:["25% MAC","50%","LE","TE"], ans:0, exp:"Aerodynamic Center.", longExp:"The point where pitching moment coefficient is constant with AoA changes." },
{ id:"D1", topic:"Drag", level:"hard", q:"Induced Drag proportional to:", options:["1/V¬≤","V¬≤","V","Weight"], ans:0, exp:"Inverse square.", longExp:"Induced drag is highest at low speeds (high AoA) and decreases as speed increases." },
{ id:"D2", topic:"Drag", level:"medium", q:"Parasite Drag proportional to:", options:["V¬≤","1/V¬≤","Weight","Lift"], ans:0, exp:"Square.", longExp:"Form, Skin Friction, and Interference drag increase rapidly with speed." },
{ id:"D3", topic:"Drag", level:"hard", q:"Vmd is where:", options:["Induced = Parasite Drag","Parasite = 0","Lift Max","Stall"], ans:0, exp:"Min Drag.", longExp:"The intersection of the two drag curves gives the minimum total drag speed." },
{ id:"D4", topic:"Drag", level:"medium", q:"Winglets reduce:", options:["Induced Drag","Form Drag","Wave Drag","Skin"], ans:0, exp:"Tip vortices.", longExp:"Winglets block the flow from bottom to top at the tip, weakening vortices." },
{ id:"D5", topic:"Drag", level:"hard", q:"Interference Drag reduced by:", options:["Fairings","Polishing","VGs","Slats"], ans:0, exp:"Smooth junctions.", longExp:"Fairings (fillets) smooth the airflow at sharp angles like the wing root." },
{ id:"S1", topic:"Stalling", level:"easy", q:"Stall depends on:", options:["Angle of Attack","Speed","Weight","Power"], ans:0, exp:"Critical Alpha.", longExp:"Stall occurs purely when the Critical Angle of Attack is exceeded." },
{ id:"S2", topic:"Stalling", level:"hard", q:"60¬∞ bank turn, stall speed increases:", options:["41%","20%","100%","10%"], ans:0, exp:"‚àö2 = 1.41.", longExp:"Load factor is 2g. Stall speed increases by square root of load factor." },
{ id:"S3", topic:"Stalling", level:"medium", q:"Ice on LE:", options:["Increases Vs, Decreases CLmax","Decreases Vs","No effect","Reduces Drag"], ans:0, exp:"Early separation.", longExp:"Ice disrupts the boundary layer, causing separation at a lower AoA." },
{ id:"S4", topic:"Stalling", level:"medium", q:"Forward CG:", options:["Increases Vs","Decreases Vs","Unstable","No effect"], ans:0, exp:"Higher effective weight.", longExp:"Tail must produce downforce, adding to the load the wings must carry." },
{ id:"S5", topic:"Stalling", level:"hard", q:"Deep Stall affects:", options:["T-tail","Low wing","Canard","Biplane"], ans:0, exp:"Blanketed tail.", longExp:"The wake of the stalled main wing blankets the high tail, causing loss of pitch control." },
{ id:"S6", topic:"Stalling", level:"medium", q:"Stall Strip:", options:["Forces root stall","Prevents stall","Clean","Light"], ans:0, exp:"Sharp edge.", longExp:"Ensures flow separation starts at the root to keep ailerons effective." },
{ id:"H1", topic:"High Lift", level:"easy", q:"Flaps increase:", options:["Camber & CLmax","Speed","Stability","Aspect Ratio"], ans:0, exp:"Curvature.", longExp:"Flaps increase camber, shifting the lift curve up to allow slower flight." },
{ id:"H2", topic:"High Lift", level:"hard", q:"Slats:", options:["Re-energize boundary layer","Increase area","Block flow","Brake"], ans:0, exp:"Slot effect.", longExp:"High pressure air from below flows through the slot to accelerate flow on top." },
{ id:"H3", topic:"High Lift", level:"medium", q:"Fowler Flaps:", options:["Increase Area & Camber","Camber only","Drag only","Thick"], ans:0, exp:"Slide back.", longExp:"They move backwards and downwards, increasing both S and CL." },
{ id:"ST1", topic:"Stability", level:"easy", q:"Static Stability:", options:["Initial tendency","Time","Oscillation","Force"], ans:0, exp:"Reaction.", longExp:"The immediate initial response to a disturbance." },
{ id:"ST2", topic:"Stability", level:"medium", q:"Longitudinal Stability:", options:["CG vs Neutral Point","Wing","Fin","Rudder"], ans:0, exp:"Pitch.", longExp:"CG must be forward of the Neutral Point for positive pitch stability." },
{ id:"ST3", topic:"Stability", level:"hard", q:"Aft CG:", options:["Decreases Stability","Increases","No effect","Increases Vs"], ans:0, exp:"Short lever arm.", longExp:"Aft CG reduces the stabilizer's effectiveness, making the aircraft less stable." },
{ id:"ST4", topic:"Stability", level:"hard", q:"Dutch Roll:", options:["Lateral > Directional Stab","Directional > Lateral","Fwd CG","Stall"], ans:0, exp:"Wallow.", longExp:"Too much dihedral (roll stability) compared to the fin (yaw stability)." },
{ id:"ST5", topic:"Stability", level:"medium", q:"Dihedral:", options:["Lateral Stability","Longitudinal","Directional","Speed"], ans:0, exp:"Roll.", longExp:"Wings angled up help return the aircraft to level flight after a disturbance." },
{ id:"C1", topic:"Controls", level:"medium", q:"Adverse Yaw cause:", options:["Induced Drag on up-wing","Torque","Rudder","Slip"], ans:0, exp:"Lift = Drag.", longExp:"The wing rising creates more lift and thus more induced drag, pulling the nose back." },
{ id:"C2", topic:"Controls", level:"hard", q:"Mass Balance:", options:["Prevents Flutter","Stall","Spin","Yaw"], ans:0, exp:"CG on hinge.", longExp:"Aligns the control surface CG with the hinge line to prevent aeroelastic flutter." },
{ id:"C3", topic:"Controls", level:"medium", q:"Differential Ailerons:", options:["Up moves more than down","Down more","Equal","None"], ans:0, exp:"Reduces Adverse Yaw.", longExp:"The up-going aileron creates more form drag to balance the induced drag of the other wing." },
{ id:"C4", topic:"Controls", level:"medium", q:"Frise Aileron:", options:["Projects LE down","Spoiler","Equal","Up"], ans:0, exp:"Drag creation.", longExp:"The nose of the up-going aileron protrudes into the airflow to create drag." },
{ id:"F1", topic:"Formulas", level:"medium", q:"Load Factor (n):", options:["1 / cos(œÜ)","sin(œÜ)","tan(œÜ)","cos(œÜ)"], ans:0, exp:"Bank angle.", longExp:"n = Lift/Weight. In a turn, L = W/cos(bank)." },
{ id:"F2", topic:"Formulas", level:"hard", q:"Vs vs Weight:", options:["Vs2 = Vs1 * ‚àö(W2/W1)","Linear","Square","None"], ans:0, exp:"Root relationship.", longExp:"Stall speed varies with the square root of the weight change." },
{ id:"F3", topic:"Formulas", level:"hard", q:"Turn Radius:", options:["V¬≤ / (g tan œÜ)","V / tan œÜ","V g","V¬≤"], ans:0, exp:"V squared.", longExp:"Radius increases rapidly with speed and decreases with bank angle." },
{ id:"F4", topic:"Formulas", level:"hard", q:"Rate of Turn:", options:["g tan œÜ / V","V / R","V tan œÜ","Const"], ans:0, exp:"Inverse V.", longExp:"For a fixed bank, faster speed means slower rate of turn." },{ id:"F5", topic:"Formulas", level:"medium", q:"Dynamic Pressure (q):", options:["1/2 œÅ V¬≤","œÅ V","Pt","V¬≤"], ans:0, exp:"Kinetic.", longExp:"Energy of the air motion per unit volume." },
{ id:"F6", topic:"Formulas", level:"medium", q:"Lift Coefficient:", options:["L / (q S)","L q S","D/L","q/S"], ans:0, exp:"Rearranged lift formula.", longExp:"CL is the dimensionless lift capability of the wing." },
{ id:"F7", topic:"Formulas", level:"easy", q:"Force (Newton):", options:["F = ma","F = mv","F = mgh","F = 1/2mv"], ans:0, exp:"2nd Law.", longExp:"Force equals mass times acceleration." },
{ id:"F8", topic:"Formulas", level:"medium", q:"Momentum:", options:["p = mv","p = ma","p = 1/2mv2","p = Fd"], ans:0, exp:"Mass x Velocity.", longExp:"Quantity of motion." },
{ id:"F9", topic:"Formulas", level:"hard", q:"Glide Ratio:", options:["Lift / Drag","Thrust / Drag","Weight / Lift","Speed / Fuel"], ans:0, exp:"Efficiency.", longExp:"Distance traveled per unit height lost." },
{ id:"F10", topic:"Formulas", level:"medium", q:"Power:", options:["Force x Velocity","Force x Time","Mass x Accel","Energy"], ans:0, exp:"Rate of work.", longExp:"Power is work done over time, or Force times Velocity." },
{ id:"F11", topic:"Formulas", level:"hard", q:"Climb Gradient:", options:["(T-D)/W","L/W","T/W","D/L"], ans:0, exp:"Excess Thrust.", longExp:"The angle of climb depends on Excess Thrust vs Weight." },
{ id:"X1", topic:"Definitions", level:"easy", q:"Mass unit:", options:["Kg","N","J","W"], ans:0, exp:"SI.", longExp:"Kilogram is mass. Newton is force." },
{ id:"X2", topic:"Definitions", level:"medium", q:"Work:", options:["Force x Distance","Force x Time","Mass x V","Power"], ans:0, exp:"Joules.", longExp:"Work is done when a force moves an object." },
{ id:"X3", topic:"Atmosphere", level:"hard", q:"Altimeter in cold air:", options:["Overreads","Underreads","Correct","Zero"], ans:0, exp:"High to Low, look below.", longExp:"In cold air, the column contracts. You are lower than indicated." },
{ id:"X4", topic:"Atmosphere", level:"hard", q:"True Altitude:", options:["Exact AMSL","AGL","Pressure","Indicated"], ans:0, exp:"Geometric.", longExp:"The actual vertical distance above sea level." },
{ id:"X5", topic:"Basic Aero", level:"medium", q:"Static + Dynamic =:", options:["Total Pressure","Ambient","Lift","Weight"], ans:0, exp:"Bernoulli.", longExp:"Total (Stagnation) pressure is constant." },
{ id:"X6", topic:"Basic Aero", level:"easy", q:"Continuity:", options:["A1V1 = A2V2","F=ma","PV=nRT","L=W"], ans:0, exp:"Mass flow.", longExp:"Area times Velocity is constant in a tube." },
{ id:"X7", topic:"Lift", level:"medium", q:"Symmetrical Airfoil at 0 AoA:", options:["Zero Lift","Pos Lift","Neg Lift","Drag"], ans:0, exp:"No camber.", longExp:"Pressure is equal on both sides." },
{ id:"X8", topic:"Lift", level:"hard", q:"Stagnation Point:", options:["V=0, P=Max","V=Max","P=Min","Sep"], ans:0, exp:"Stop.", longExp:"Where the airflow hits the LE and stops completely." },
{ id:"X9", topic:"Drag", level:"medium", q:"Skin Friction:", options:["Parasite Drag","Induced","Wave","Lift"], ans:0, exp:"Surface roughness.", longExp:"Air viscosity dragging on the surface." },
{ id:"X10", topic:"Drag", level:"hard", q:"Form Drag reduced by:", options:["Streamlining","Polishing","Aspect Ratio","Weight"], ans:0, exp:"Shape.", longExp:"Making the object more aerodynamic (teardrop)." },
{ id:"X11", topic:"Stalling", level:"hard", q:"Spin:", options:["Aggravated Stall + Yaw","Spiral","Dive","Turn"], ans:0, exp:"Auto-rotation.", longExp:"One wing is more stalled than the other." },
{ id:"X12", topic:"Stalling", level:"medium", q:"Spin Recovery:", options:["PARE","Power Max","Stick Back","Aileron"], ans:0, exp:"Standard.", longExp:"Power Idle, Aileron Neutral, Rudder Opposite, Elevator Forward." },
{ id:"X13", topic:"Stalling", level:"hard", q:"Accelerated Stall:", options:["Stall > Vs due to G","Low speed","Ground","Ice"], ans:0, exp:"High Load.", longExp:"Stalling at high speed due to pulling Gs." },
{ id:"X14", topic:"High Lift", level:"medium", q:"Split Flap:", options:["High Drag","Low Drag","Lift only","Fast"], ans:0, exp:"Draggy.", longExp:"Great for steep approaches due to high drag." },
{ id:"X15", topic:"High Lift", level:"medium", q:"Krueger Flap:", options:["Leading Edge","Trailing","Tip","Rudder"], ans:0, exp:"LE device.", longExp:"Hinged panel on the leading edge." },
{ id:"X16", topic:"Stability", level:"hard", q:"Spiral Dive:", options:["Strong Dir / Weak Lat","Weak Dir","Aft CG","Stall"], ans:0, exp:"Opposite Dutch Roll.", longExp:"Aircraft tightens into a spiral dive." },
{ id:"X17", topic:"Stability", level:"medium", q:"Stick Force/G:", options:["Manoeuvre Stability","Static","Speed","Drag"], ans:0, exp:"Feel.", longExp:"How heavy the controls feel to pull Gs." },
{ id:"X18", topic:"Controls", level:"medium", q:"Servo Tab:", options:["Moves main surface","Trim","Brake","Lock"], ans:0, exp:"Pilot moves tab.", longExp:"Reduces stick force by using the tab to drive the surface." },
{ id:"X19", topic:"Controls", level:"hard", q:"Anti-Balance Tab:", options:["Increases force","Decreases","Trim","Flutter"], ans:0, exp:"Feel.", longExp:"Moves same way as surface to make controls heavier." },
{ id:"X20", topic:"Controls", level:"medium", q:"Horn Balance:", options:["Aerodynamic balance","Mass","Weight","Trim"], ans:0, exp:"Projecting corner.", longExp:"Area forward of hinge aids movement." },
{ id:"M1", topic:"Mechanics", level:"medium", q:"Vx:", options:["Best Angle","Best Rate","Max Speed","Min Fuel"], ans:0, exp:"Obstacle.", longExp:"Steepest climb." },
{ id:"M2", topic:"Mechanics", level:"medium", q:"Vy:", options:["Best Rate","Best Angle","Max","Min Drag"], ans:0, exp:"Time.", longExp:"Fastest climb to altitude." },
{ id:"M3", topic:"Mechanics", level:"hard", q:"V1:", options:["Decision Speed","Rotate","Safety","Climb"], ans:0, exp:"Go/No Go.", longExp:"Max speed to abort takeoff." },
{ id:"M4", topic:"Mechanics", level:"hard", q:"Vmca:", options:["Min Control Air","Ground","Max","Stall"], ans:0, exp:"One engine.", longExp:"Minimum speed to keep straight." },
{ id:"M5", topic:"Mechanics", level:"hard", q:"Vne:", options:["Never Exceed","Normal","Stall","Manoeuvre"], ans:0, exp:"Red line.", longExp:"Structural damage limit." },
{ id:"M6", topic:"Mechanics", level:"medium", q:"Load Factor 45¬∞:", options:["1.41 g","1.1","2","1"], ans:0, exp:"1/cos45.", longExp:"Significant load increase." },
{ id:"M7", topic:"Mechanics", level:"hard", q:"Balanced Field:", options:["ASDA = TODA","TORA","LDA","V1"], ans:0, exp:"Stop = Go.", longExp:"Distance to stop equals distance to go." },
{ id:"M8", topic:"Mechanics", level:"medium", q:"Hydroplaning:", options:["9 ‚àöP","7 ‚àöP","Vref","Vs"], ans:0, exp:"Tire pressure.", longExp:"Speed where tire loses contact." },
{ id:"M9", topic:"Mechanics", level:"medium", q:"Headwind Takeoff:", options:["Shorter run","Longer","Same","Hot"], ans:0, exp:"Groundspeed.", longExp:"Already have airspeed on runway." },
{ id:"M10", topic:"Mechanics", level:"medium", q:"Tailwind Landing:", options:["Longer distance","Shorter","Same","Safe"], ans:0, exp:"Groundspeed.", longExp:"High groundspeed increases distance." },
{ id:"P1", topic:"Definitions", level:"easy", q:"ISA Sea Level Temp:", options:["15¬∞C","0","20","-5"], ans:0, exp:"Standard.", longExp:"15 degrees Celsius." },
{ id:"P2", topic:"Atmosphere", level:"easy", q:"Pressure decrease:", options:["1hPa / 27ft","100ft","50ft","10ft"], ans:0, exp:"Low level.", longExp:"Approx 30ft per hPa." },
{ id:"P3", topic:"Lift", level:"medium", q:"Magnus Effect:", options:["Rotating cylinder","Flat plate","Sphere","Box"], ans:0, exp:"Rotation.", longExp:"Lift from rotation." },
{ id:"P4", topic:"Drag", level:"hard", q:"Zero Lift Drag:", options:["Parasite","Induced","Lift","Weight"], ans:0, exp:"Form+Friction.", longExp:"Drag at zero lift." },
{ id:"P5", topic:"Stalling", level:"hard", q:"Stick Pusher:", options:["Prevents Deep Stall","Warning","Trim","Landing"], ans:0, exp:"Active.", longExp:"Pushes nose down automatically." },
{ id:"P6", topic:"Stability", level:"medium", q:"Anhedral:", options:["Reduces Lateral Stab","Increases","Lift","Drag"], ans:0, exp:"High wing.", longExp:"Destabilizing roll effect." },
{ id:"P7", topic:"Controls", level:"medium", q:"Fly By Wire:", options:["Computer protection","Mechanical","Cable","Hydraulic"], ans:0, exp:"Envelope.", longExp:"Limits flight path." },
{ id:"P8", topic:"Formulas", level:"medium", q:"Specific Range:", options:["TAS / Fuel Flow","Fuel/TAS","Power","Drag"], ans:0, exp:"Efficiency.", longExp:"Miles per gallon." },
{ id:"P9", topic:"Formulas", level:"easy", q:"Aspect Ratio:", options:["Span¬≤/Area","Chord","Thick","Area"], ans:0, exp:"Slenderness.", longExp:"Geometric efficiency." },
{ id:"P10", topic:"Definitions", level:"medium", q:"Relative Airflow:", options:["Opposite Flight Path","With Path","90 deg","Vertical"], ans:0, exp:"Vector.", longExp:"Opposite to velocity." },
{ id:"Z1", topic:"Atmosphere", level:"medium", q:"Inversion:", options:["Temp increases with height","Decreases","Constant","Zero"], ans:0, exp:"Stable.", longExp:"Warm air over cold." },
{ id:"Z2", topic:"Lift", level:"hard", q:"Vortilon:", options:["LE device","TE","Tip","Fin"], ans:0, exp:"Vortex.", longExp:"Generates vortex at high alpha." },
{ id:"Z3", topic:"Drag", level:"medium", q:"Laminar Flow:", options:["Low friction","High","Turbulent","Rough"], ans:0, exp:"Smooth.", longExp:"Delays transition." },
{ id:"Z4", topic:"Stalling", level:"hard", q:"Vs1g:", options:["Lower than Vs","Higher","Same","Zero"], ans:0, exp:"1g stall.", longExp:"Usually higher than min speed." },
{ id:"Z5", topic:"Stability", level:"hard", q:"Mach Tuck:", options:["Nose Down","Up","Roll","Yaw"], ans:0, exp:"High speed.", longExp:"CP moves aft." },
{ id:"Z6", topic:"Controls", level:"medium", q:"Spoiler:", options:["Dumps lift","Adds lift","Thrust","Yaw"], ans:0, exp:"Brake.", longExp:"Destroys lift." },
{ id:"Z7", topic:"Formulas", level:"hard", q:"Kinetic Energy:", options:["1/2 m V¬≤","mv","mgh","ma"], ans:0, exp:"Motion.", longExp:"Square of speed." },
{ id:"Z8", topic:"Definitions", level:"easy", q:"Weight:", options:["Mass x Gravity","Mass","Force","Speed"], ans:0, exp:"N.", longExp:"Force of gravity." },
{ id:"Z9", topic:"Atmosphere", level:"medium", q:"Isothermal:", options:["Constant Temp","Rising","Falling","Zero"], ans:0, exp:"Same.", longExp:"No change with height." },
{ id:"Z10", topic:"Lift", level:"medium", q:"Chord Line:", options:["LE to TE","Camber","Span","Thickness"], ans:0, exp:"Straight.", longExp:"Geometric reference." }
];

const app={
state:{mode:'practice',pool:[],idx:0,answers:[],used:JSON.parse(localStorage.getItem('ATPL_V19')||"[]")},
init:function(){document.getElementById('dbInfo').innerText=`Chapters 1-10: ${DB.length} Questions.`},
setM:function(m){
this.state.mode=m;
document.querySelectorAll('.mode-btn').forEach(b=>b.className='mode-btn');
document.getElementById('m-'+m).classList.add('active-'+m);
document.body.className='mode-'+m;
const b=document.getElementById('btnStart');
b.style.backgroundColor=m==='practice'?'var(--primary)':m==='formulas'?'var(--purple)':'var(--orange)';
document.getElementById('dif').style.display=m==='practice'?'block':'none';
},
start:function(){
const cnt=parseInt(document.getElementById('num-sel').value);
const dif=document.getElementById('diff-sel').value;
let c=DB;
if(this.state.mode==='formulas')c=DB.filter(q=>q.topic==='Formulas');
else if(this.state.mode==='practice'){let s=DB.filter(q=>q.level===dif);if(s.length>4)c=s}
c.sort(()=>Math.random()-0.5);
this.state.pool=c.slice(0,cnt);
this.state.answers=new Array(this.state.pool.length).fill(null);
this.state.idx=0;
document.getElementById('view-home').classList.add('hidden');
document.getElementById('view-quiz').classList.remove('hidden');
document.getElementById('nav').classList.remove('hidden');
this.load();
},
load:function(){
const q=this.state.pool[this.state.idx];
const a=this.state.answers[this.state.idx];
document.getElementById('cnt').innerText=`${this.state.idx+1} / ${this.state.pool.length}`;
document.getElementById('qTop').innerText=q.topic;
document.getElementById('qLvl').innerText=q.level.toUpperCase();
document.getElementById('qTxt').innerHTML=q.q;
const b=document.getElementById('opts');b.innerHTML='';
document.getElementById('expl').classList.remove('show');
q.options.forEach((o,i)=>{
const d=document.createElement('div');d.className='option';d.innerHTML=o;
d.onclick=()=>this.ans(i);
if(this.state.mode!=='exam'){
if(a!==null){if(i===q.ans)d.classList.add('correct');else if(i===a)d.classList.add('wrong')}
}else if(a===i)d.classList.add('selected');
b.appendChild(d);
});
if(this.state.mode!=='exam'&&a!==null){
document.getElementById('sh-exp').innerHTML=`<strong>Answer:</strong> ${q.exp}`;
document.getElementById('expl').classList.add('show');
}
const act=document.getElementById('act');
act.innerText=(this.state.idx===this.state.pool.length-1)?(this.state.mode==='exam'?'Submit':'Finish'):'Next';
if(this.state.mode==='exam'&&this.state.idx===this.state.pool.length-1)act.style.backgroundColor='var(--orange)';
},
ans:function(i){
if(this.state.mode!=='exam'&&this.state.answers[this.state.idx]!==null)return;
this.state.answers[this.state.idx]=i;
this.load();
},
deep:function(){
const q=this.state.pool[this.state.idx];
document.getElementById('dp-txt').innerHTML=q.longExp||"No details.";
document.getElementById('mod').classList.add('open');
},
close:function(e){if(!e||e.target===e.currentTarget||e.target.tagName==='BUTTON')document.getElementById('mod').classList.remove('open')},
next:function(){if(this.state.idx<this.state.pool.length-1){this.state.idx++;this.load()}else this.end()},
back:function(){if(this.state.idx>0){this.state.idx--;this.load()}},
end:function(){
if(this.state.mode==='exam'&&!confirm("Submit?"))return;
let c=0;this.state.answers.forEach((a,i)=>{if(a===this.state.pool[i].ans)c++});
const p=Math.round((c/this.state.pool.length)*100);
document.getElementById('view-quiz').classList.add('hidden');
document.getElementById('nav').classList.add('hidden');
document.getElementById('view-res').classList.remove('hidden');
document.getElementById('score').innerText=p+"%";
},
wipe:function(){if(confirm("Reset?")){localStorage.removeItem('ATPL_V19');location.reload()}},
quit:function(){if(confirm("Exit?"))location.reload()}
};
app.init();
</script>
</body>
</html>
